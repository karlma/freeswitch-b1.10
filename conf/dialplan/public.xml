<!-- http://wiki.freeswitch.org/wiki/Dialplan_XML -->
<include>
  <context name="public">

    <extension name="unloop">
      <condition field="${unroll_loops}" expression="^true$"/>
      <condition field="${sip_looped_call}" expression="^true$">
	<action application="deflect" data="${destination_number}"/>
      </condition>
    </extension>

    <!-- Try to get target_domain from the sip_req_params variable -->
    <extension name="set_domain" continue="true">
      <condition field="${target_domain}" expression="^$" break="never"/>
      <condition field="source" expression="mod_sofia" break="never"/>
      <condition field="${sip_req_params}" expression="target_domain=([A-Z-a-z0-9.]+)" break="never">
	<action application="set" data="target_domain=$1"/>
	<anti-action application="set" data="target_domain=$${domain}"/>
      </condition>
    </extension>

    <extension name="call_debug">
      <condition field="${call_debug}" expression="^true$" break="never">
	<action application="info"/>
      </condition>
    </extension>

    <extension name="public_extensions">
      <condition field="destination_number" expression="^(10[01][0-9])$">
	<action application="transfer" data="$1 XML default"/>
      </condition>
    </extension>

    <X-PRE-PROCESS cmd="include" data="public/*.xml"/>

  </context>
</include>
